<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <!--
Copyright (c) 2008, Jack J. Woehr jwoehr@softwoehr.com
PO Box 51, Golden, Colorado 80402-0051 USA
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

    * Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer
        in the documentation and/or other materials provided with the
        distribution.
    * Neither the name of the PigIron Project nor the names of its
        contributors may be used to endorse or promote products derived
        from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE.
-->
    <title>PigGen Autogenerator</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
    <h1><a name="Image_of_noble_porcine"></a><img
        title="Image of noble porcine" alt="Image of noble porcine"
        src="pigiron.sourceforge.net/images/pig_15.gif"
        style="width: 157px; height: 116px;" align="middle">PigGen
    AutoGenerator for <a href="index.html">PigIron</a></h1>
    <p><tt>Copyright (c) 2008, Jack J. Woehr jwoehr@softwoehr.com PO Box
    51, Golden, Colorado 80402-0051 USA All rights reserved.</tt></p>
    <p>[ <a href="./index.html">Back to PigIron Index</a> ] [ <a
        href="http://pigiron.sourceforge.net">PigIron Home Page</a> ] [ <a
      href="http://sourceforge.net/projects/pigiron">Download PigIron</a> ]</p>
    <h2>Contents</h2>
    <ul>
      <li><a href="#Overview">Overview</a></li>
      <li><a href="#Disclaimers">Disclaimers</a>
        <ul>
          <li><a href="#Open_Source">Open Source</a></li>
          <li><a href="#NOTE_ON_SECURITY">NOTE ON SECURITY (LACK THEREOF)</a></li>
          <li><a href="#Lawyer-B-Gone">Non-Association with IBM</a></li>
        </ul>
      </li>
      <li><a href="#Credits">Credits</a></li>
      <li><a href="#Specification">Specification</a>
        <ul>
          <li><a href="#How_PigGen_Works">How PigGen Works</a></li>
          <li><a href="#Invocation">Invocation</a></li>
          <li><a href="#Description_Files">Description Files</a></li>
          <li><a href="#Macro_Reference">Macro Reference</a></li>
        </ul>
      </li>
    </ul>
    <h2><a name="Overview">Overview of PigIron's PigGen</a></h2>
    <p>PigGen autogenerates Java source code to embody <a href="index.html">PigIron</a>-specific
      VSMAPI parameter structures and arrays and VSMAPI function calls for
      either native VSMAPI functions or for your own custom VSMAPI host-side
    functions.</p>
    <p>You have two uses for PigGen: </p>
    <ol>
      <li>You can extend PigIron as IBM adds new VSMAPI Functions (along
        with their complement of parameter structures and arrays) without your
      having to understand PigIron's Java source code intimately.</li>
      <li>You can extend PigIron with calls to support your own
        custom-coded host-side extensions to VSMAPI (since VSMAPI supports
      custom extension coding). </li>
    </ol>
    <h2><a name="Disclaimers">Disclaimers</a></h2>
    <ul>
      <li><a name="Open_Source">PigIron is open source software</a> and as
        such comes with NO WARRANTY and NO GUARANTEE.
        <ul>
          <li>Please <a href="./license.txt">view the BSD-style license
          for the PigIron Class Library</a>.</li>
        </ul>
      </li>
      <li><a name="NOTE_ON_SECURITY">NOTE ON SECURITY (LACK THEREOF)</a>
        <ul>
          <li>Currently there is NO secure sockets implementation. PigIron
          sends any password info in CLEAR TEXT.</li>
          <li>Use ONLY on a secure LAN behind a firewall.</li>
        </ul>
      </li>
      <li><a name="Lawyer-B-Gone">PigIron is not associated</a> with the
        IBM corporation, which owns most or all of the trademarks mentioned in
      PigIron documentation.</li>
    </ul>
    <h2><a name="#Credits">Credits</a></h2>
    Thanks to <a href="http://www.designedtoat.com">Free Original Clipart
    at Designed to a T</a> for the <a href="#Image_of_noble_porcine">pig
    image</a>!
    <hr>
    <h2><a name="Specification">Specification</a></h2>
    <h3>Why PigGen</h3>
    <p>VSMAPI is extensible on the Host by Rexx programming. You may wish
      at sometime to extend PigIron's class library support to support
      functions you and your team members have coded on the Host. Supporting
      a new VSMAPI function in PigIron requires Java classes which implement
      the function and its parameters. PigGen is a macro language which will
      author these classes for you from a description file. You do not even
      have to know Java beyond knowing how to compile everything after PigGen
      has autogenerated your code.<br>
    </p>
    <div style="margin-left: 40px;">
      <h3>Interesting Conversational Snippet on the Why of PigGen</h3>
      (10:08:15) Dave Jones: looking at class VSMCall....this is beginning to
      make sense..<br>
      (10:09:46) Uncle Jax: Right, that's the base from which all funct calls
      are extended. Class commonality. But DESIGN PATTERN COMMONALITY e.g.,
      each VSMAPI FUnction class layout of composeInput() and composeOutput()
      is not subject to inheritance factoring .. the commonality is more
      easily expressed in m4 macros.<br>
      (10:10:03) Dave Jones: OK<br>
      (10:10:18) Uncle Jax: Makes up for Java not having templates like C++
    does.</div>
    <h3><a name="How_PigGen_Works">How PigGen Works</a></h3>
    <p>PigGen is a library of macros written in the <a
        href="http://www.gnu.org/software/m4/">Gnu m4</a> macro language.
      These macros allow you to create new VSMAPI parameter structures and
    arrays, and new VSMAPI function calls.</p>
    <p>PigGen is implemented in a few macro files: </p>
    <ul>
      <li><tt>/pigiron/piggen/pigsty.m4 ... common macros shared by other
      macro files</tt></li>
      <li><tt>/pigiron/piggenpigstruct.m4 ... macros to define parameter
      structures</tt></li>
      <li><tt>/pigiron/piggenpigarray.m4 ... macros to define arrays of
      parameter structures</tt></li>
      <li><tt>/pigiron/piggenpigfunc.m4 ... macros to define functions</tt></li>
    </ul>
    There are also a few additional files such as shell scripts which
    support the process of generating these macros.
    <h3><a name="Invocation">Invocation</a></h3>
    <p>PigGen runs from its own directory, <tt>/pigiron/piggen/</tt> and
      compiles <a href="#Description_Files">description files</a> written in
    PigGen macros into Java source code.</p>
    <h4>Compiling one file</h4>
    <blockquote><tt>cd</tt> <i>piggen_dir</i> <tt>; ./piggen.sh</tt> <i>macroized_description_file
    output_directory</i></blockquote>
    E.g, assuming you have unpacked the archive <tt>pigiron-</tt><i>release_num</i><tt>.zip</tt>
    into <tt>/usr/local/src/</tt> and have made your own directories, one
    for custom source in <tt>/usr/local/work/mysrc/</tt> and one for java
    code waiting to be compiled in <tt>/usr/local/work/myjava/</tt>:
    <blockquote><tt>cd /usr/local/src/pigiron/piggen ; ./piggen.sh
    /usr/local/work/mysrc/my_custom_struct.m4 /usr/local/wrk/myjava</tt></blockquote>
    <p><tt><b>TODO:</b></tt> describe Java compilation of resulting code</p>
    <h3><a name="Description_Files">Description Files</a></h3>
    <p>PigGen description files describe VSMAPI structures, arrays and
      functions. From the description, PigGen writes Java class source code.
      You then move the source code to the correct directory and compile it
      as part of a recompile of the PigIron project. After this process is
      complete, PigIron is able to call your custom-coded VSMAPI functions.
      All PigIron representation of highlevel VSMAPI structures, arrays and
      functions were authored using PigGen (except for a very few at the
      start of coding the project which we have left in their original source
    form).</p>
    <p><b>Note:</b> The full PigGen description source for the applicable
      components of the PigIron class library is included with PigIron, along
      with a target in the master <tt>build.xml</tt> file for building them.
      However, generating the Java source from the PigGen description files
      is <u>not</u> part of the typical PigIron. Instead, PigIron's own
      VSMAPI classes were regenerated after the latest modifications of the
      description files and checked in themselves as Java source code in <tt>pigiron/src/com/softwoehr/pigiron/access/paramstructs/</tt>
      (for structures and arrays) and <tt>pigiron/src/com/softwoehr/pigiron/functions/</tt>
    (for functions).</p>
    <p>PigGen description files are written in the <a
        href="http://www.gnu.org/software/m4/">Gnu m4</a> macro language. To
      successfully write a PigGen description file you must follow both the
      rules of m4 and the rules of PigGen. m4 syntax is notoriously
      difficult, but you are only required to understand a small subset of
    the rules and mostly just follow directions and examples.</p>
    <h4>Easy m4</h4>
    <ul>
      <li>To quote something against macro expansion in m4, you lead it
        with backtick (<tt>`</tt>) and trail it with single-quote (<tt>'</tt>),
      e.g., <tt>doNotExpandMe(`this quoted string')</tt> .</li>
      <li>m4 macros take their arguments <tt>(`in', `parentheses', `like',
      `these')</tt> with comma separation.</li>
      <li>An argument in some circumstances may be unquoted, but if quoted,
        leading space before the backtick (<tt>`</tt>) in an argument is
      ignored while trailing space is included in the expansion.</li>
      <li>Everything in a macro file is expanded or passed on to the output
        stream, hence the ubiquitous use of m4's <tt>dnl</tt> macro which
      discards all subsequent text on a line <u>and the next newline also</u>.</li>
      <li>Macros that have no arguments don't need their <tt>()</tt> to
        expand, but if there is any ambiguity when a macro abuts non-macro
      text, you use <tt>()</tt> to disambiguate.</li>
    </ul>
    <p>m4 is designed to let you process any text, but there are
      limitations in the use to which PigGen puts m4. This means that you do
      not really need to know much more about m4 than we have stated above to
      use PigGen, given that there are over one hundred examples of
    description file coding included with PigGen.</p>
    <h4>Description File Coding</h4>
    <ul>
      <li>The description file must be complete and correct to generate
      correct Java code.</li>
      <li>Each line of the description file should usually end with the <tt>dnl</tt>
        macro.
        <ul>
          <li>The exception is when you are entering inline text such as
          your own custom-coded function or text comment.</li>
        </ul>
      </li>
      <li>On the first line in your description file <tt>include()</tt>
        the appropriate PigGen .m4 file.
        <ul>
          <li>To define a VSMAPI structure: <tt>include(`pigstruct.m4')</tt></li>
          <li>To define an array of VSMAPI structures: <tt>include(`pigarray.m4')</tt></li>
          <li>To define a VSMAPI function: <tt>include(`pigfunc.m4')</tt></li>
        </ul>
      </li>
      <li>Names used for members and functions should always be of one of
        the form:
        <ul>
          <li><tt>lcase_lcase</tt></li>
          <li><tt>lcase_lcase_lcase</tt></li>
          <li><tt>lcase_lcase_lcase_lcase</tt></li>
        </ul>
      </li>
      <li>PigGen javaizes these forms into either member name format (<tt>lcaseUlcaseUlcase</tt>
        ... etc.) or class name format (<tt>UlcaseUlcaseUlcase</tt> ... etc.)
      as appropriate.</li>
      <li>When you name a structure type or array type in describing a new
        structure type, you always name it in class name format (initial
      capital).</li>
      <!-- li></li>
      <li></li>
      <li></li>
      <li></li -->
    </ul>
    <h3><a name="Macro_Reference">Macro Reference</a></h3>
    <p>Macros are listed here by <tt>include</tt> file, in order in which
      they normally appear in a description file.<br>
    </p>
    <h4><tt>pigsty.m4</tt></h4>
    <table border="1" cellpadding="4">
      <thead> <tr>
          <th>macro</th>
          <th>description</th>
          <th>example</th>
        </tr>
      </thead> <tbody>
        <tr>
          <td><tt>param_namespace(`entity', `associated_function')</tt></td>
          <td>Opens a namespace in which certain names conventional to the
            construction of parameter description files are pre-defined on the
            basis of the entity name an associated function name.<br>
            <ul>
              <li><span style="font-family: monospace;">entity</span>&nbsp;
                is the stem of the entity under definition, e.g., <span
                  style="font-family: monospace;">failing</span> which is the stem of <span
                  style="font-family: monospace;">failing_structure</span> , <span
                  style="font-family: monospace;">failing_structure_counted</span> , etc.<br>
              </li>
              <li><tt>associated_function</tt> is the VSMAPI Function for
              which this parameter is being defined</li>
            </ul>
            <tt>param_namespace</tt> should be called right after the include
            macro at the top of a description file. It must be matched by a <tt>param_namespace_end()</tt>
          at the very end of the same description file. </td>
          <td><tt><br>
          </tt></td>
        </tr>
        <tr>
          <td><tt>param_namespace_end()</tt></td>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td><tt>function_namespace(`function_formal_name',
          `significant_parameter_formal_name')</tt></td>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td><tt>function_namespace_end()</tt></td>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td><tt>javaize(`formal_name')</tt></td>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td><tt>javaize_lc(`formal_name')</tt></td>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>
    <h4><tt>pigarray.m4</tt></h4>
    <table border="1" cellpadding="4">
      <thead> <tr>
          <th>macro</th>
          <th>description</th>
          <th>example</th>
        </tr>
      </thead> <tbody>
        <tr>
          <td><tt>pigparm_import(`import_name')</tt></td>
          <td>Conveys an imported class specification to Java.</td>
          <td><tt>pigparm_import(`com.softwoehr.pigiron.access.*')</tt></td>
        </tr>
        <tr>
          <td><tt>pigparm_class(`name',`extends',`package',`comment')</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_constant(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_attribute(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_ctors()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_function(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_endclass</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
      </tbody>
    </table>
    <h4><tt>pigstruct.m4</tt></h4>
    <table border="1" cellpadding="4">
      <thead> <tr>
          <th>macro</th>
          <th>description</th>
          <th>example</th>
        </tr>
      </thead> <tbody>
        <tr>
          <td><tt>pigparm_import(`import_name')</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_class(`name',`extends',`package',`comment')</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_constant(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_attribute(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_ctors()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_function(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigparm_endclass</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
      </tbody>
    </table>
    <h4><tt>pigfunc.m4</tt></h4>
    <table border="1" cellpadding="4">
      <thead> <tr>
          <th>macro</th>
          <th>description</th>
          <th>example</th>
        </tr>
      </thead> <tbody>
        <tr>
          <td><tt>pigfunc_import(`import_name')</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_class(`name',`extends',`package',`function_name',`comment')</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_ctors(OPTIONAL</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_constant(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_attribute(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_function(`accessor',</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_input_start()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_input_parm(type,</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_optional_input_parm(type, value, formal_name)</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_input_end()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_output_start()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_output_parm(type,</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_compose_output_end()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
        <tr>
          <td><tt>pigfunc_endclass()</tt></td>
          <td><br>
          </td>
          <td><tt></tt><br>
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <p><a href="http://pigiron.sourceforge.net">The PigIron Project</a></p>
    <hr>
  </body>
</html>
